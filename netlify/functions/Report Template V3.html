<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WebDoctor Health Report — Preview</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: "Montserrat", Arial, sans-serif;
      background: #e5e7eb;
      margin: 0;
      padding: 28px 0;
      color: #0f172a;
    }
    .wd-shell {
      max-width: 980px;
      margin: 0 auto;
      padding: 0 16px;
    }
    .wd-report {
      background: #fff;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 0 18px 38px rgba(15, 23, 42, 0.09);
      border: 1px solid rgba(148, 163, 184, 0.16);
    }
    .wd-header {
      background: linear-gradient(135deg, #0f766e, #14b8a6);
      color: #fff;
      padding: 30px 34px 26px;
    }
    .wd-header h1 {
      margin: 0;
      font-size: 26px;
      letter-spacing: -0.01em;
    }
    .wd-subtitle {
      opacity: 0.92;
      margin-top: 4px;
      font-size: 14px;
    }
    .wd-meta {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .wd-meta-item {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 12px;
      padding: 10px 14px 8px;
      font-size: 12px;
      min-width: 170px;
      backdrop-filter: blur(3px);
    }
    .wd-meta-label {
      text-transform: uppercase;
      opacity: 0.85;
      font-weight: 500;
      font-size: 11px;
      letter-spacing: 0.03em;
    }
    .wd-meta-value {
      font-size: 13px;
      margin-top: 2px;
      font-weight: 600;
      word-break: break-all;
    }
    .wd-body {
      padding: 28px 34px 36px;
      background: #fff;
    }
    .wd-score-block {
      display: flex;
      gap: 28px;
      align-items: center;
      margin-bottom: 26px;
    }
    .wd-score-circle {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      background: conic-gradient(#14b8a6 0 290deg, #e2e8f0 290deg 360deg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #0f172a;
      font-weight: 700;
      font-size: 30px;
      position: relative;
    }
    .wd-score-circle span {
      background: #fff;
      width: 82px;
      height: 82px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
    }
    .wd-score-text h2 {
      margin: 0;
      font-size: 18px;
    }
    .wd-score-text p {
      margin: 4px 0 0;
      font-size: 13px;
      color: #475569;
      max-width: 480px;
    }
    .wd-section-title {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #0f172a;
      margin-top: 32px;
      margin-bottom: 14px;
      font-weight: 700;
    }
    .wd-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
    }
    .wd-card {
      background: #fff;
      border: 1px solid #e2e8f0;
      border-radius: 14px;
      padding: 14px 14px 12px;
    }
    .wd-card h3 {
      margin: 0 0 5px;
      font-size: 14px;
    }
    .wd-card p {
      margin: 0;
      font-size: 12.5px;
      color: #475569;
      line-height: 1.5;
    }
    .wd-badge-critical {
      display: inline-block;
      background: rgba(248, 113, 113, 0.18);
      color: #b91c1c;
      font-size: 10.5px;
      padding: 2px 8px 1px;
      border-radius: 14px;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      margin-bottom: 8px;
      font-weight: 600;
    }
    .wd-badge-ok {
      display: inline-block;
      background: rgba(34,197,235,0.14);
      color: #0369a1;
      font-size: 10.5px;
      padding: 2px 8px 1px;
      border-radius: 14px;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      margin-bottom: 8px;
      font-weight: 600;
    }
    .wd-actions {
      display: flex;
      justify-content: center;
      gap: 16px;
      padding: 28px 0 20px;
      background: #fff;
      border-top: 1px solid #e2e8f0;
    }
    .wd-actions button {
      background: #0f766e;
      color: #fff;
      border: none;
      padding: 10px 22px;
      border-radius: 10px;
      font-family: "Montserrat", sans-serif;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .wd-actions button:hover {
      background: #115e56;
    }
    .wd-footer {
      border-top: 1px solid #e2e8f0;
      text-align: center;
      font-size: 11px;
      color: #94a3b8;
      padding: 16px;
      background: #fff;
    }
    @media (max-width: 600px) {
      .wd-body { padding: 22px 18px 30px; }
      .wd-header { padding: 24px 18px 20px; }
      .wd-score-block { flex-direction: column; align-items: flex-start; }
      .wd-score-circle { margin-bottom: 10px; }
    }
  </style>
</head>
<body>
  <div class="wd-shell">
    <div class="wd-report">
      <!-- Header -->
      <div class="wd-header">
        <h1>WebDoctor Health Report</h1>
        <div class="wd-subtitle">Scan. Diagnose. Revive.</div>
        <div class="wd-meta">
          <div class="wd-meta-item">
            <div class="wd-meta-label">Website</div>
            <div class="wd-meta-value">{{url}}</div>
          </div>
          <div class="wd-meta-item">
            <div class="wd-meta-label">Scan date</div>
            <div class="wd-meta-value">{{date}}</div>
          </div>
          <div class="wd-meta-item">
            <div class="wd-meta-label">Health Score</div>
            <div class="wd-meta-value">{{score}}</div>
          </div>
        </div>
      </div>

      <!-- Body -->
      <div class="wd-body">
        <div class="wd-score-block">
          <div class="wd-score-circle"><span>78</span></div>
          <div class="wd-score-text">
            <h2>Overall Website Health</h2>
            <p>{{summary}}</p>
          </div>
        </div>

        <div class="wd-section-title">Key Metrics</div>
        <div class="wd-grid">
          <div class="wd-card">
            <h3>Page Load</h3>
            <p><strong>1.8s</strong> (goal: &lt; 2.5s)</p>
          </div>
          <div class="wd-card">
            <h3>Mobile Usability</h3>
            <p><strong>Pass</strong> — responsive layout detected</p>
          </div>
          <div class="wd-card">
            <h3>Core Web Vitals</h3>
            <p><strong>Needs attention</strong> — CLS slightly high on hero section</p>
          </div>
        </div>

        <div class="wd-section-title">Top Issues Detected</div>
        <div class="wd-grid">
          <div class="wd-card">
            <div class="wd-badge-critical">Critical</div>
            <h3>Uncompressed hero image</h3>
            <p>Homepage hero image is 1.8MB. Compress to &lt;300KB and serve WebP.</p>
          </div>
          <div class="wd-card">
            <div class="wd-badge-critical">Critical</div>
            <h3>Missing meta description</h3>
            <p>No meta description found on homepage. Add a 140–160 character summary.</p>
          </div>
          <div class="wd-card">
            <div class="wd-badge-ok">Moderate</div>
            <h3>Heading structure</h3>
            <p>Multiple H1s detected. Use a single H1 and downgrade others to H2/H3.</p>
          </div>
        </div>

        <div class="wd-section-title">Recommended Fix Sequence</div>
        <div class="wd-card">
          <p><strong>1.</strong> Optimize media on homepage (hero + gallery)</p>
          <p><strong>2.</strong> Add SEO foundation: title, meta description, Open Graph</p>
          <p><strong>3.</strong> Fix duplicate H1s and ensure semantic order</p>
          <p><strong>4.</strong> Re-scan with WebDoctor to confirm score improvement</p>
        </div>

        <div class="wd-section-title">Notes</div>
        <div class="wd-card">
          <p>This is an automated preview based on your standard WebDoctor Report Template v3. In production, dynamic values (score, issues, dates, domain) will be injected by the automation function before PDF generation.</p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="wd-actions">
        <button id="btn-download">Download PDF</button>
        <button id="btn-email">Email Report</button>
      </div>

      <!-- Footer -->
      <div class="wd-footer">
        © 2025 WebDoctor — All Rights Reserved — Made in New Zealand.
      </div>
    </div>
  </div>

  <script>
    document.getElementById('btn-download').addEventListener('click', () => {
      window.print(); // quick local PDF via browser print
    });

    document.getElementById('btn-email').addEventListener('click', async () => {
      const email = prompt('Enter your email address to receive this report:');
      if (!email) return;
      const res = await fetch('/.netlify/functions/email-report', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email })
      });
      if (res.ok) alert('Report sent!');
      else alert('Error sending report.');
    });
  </script>
</body>
</html>
