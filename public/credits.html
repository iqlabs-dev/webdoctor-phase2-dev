<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Your WebDoctor credits</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body { font-family: Arial, sans-serif; max-width: 480px; margin: 40px auto; }
      label, input { display: block; width: 100%; }
      input { padding: 8px; margin: 8px 0 16px; }
      button { padding: 10px 16px; cursor: pointer; }
      #result { margin-top: 20px; }
    </style>
  </head>
  <body>
    <h1>Check your credits</h1>
    <p>Enter the email you used to buy credits.</p>

    <label for="email">Email</label>
    <input id="email" type="email" placeholder="you@example.com" />

    <button id="checkBtn">Check credits</button>

    <div id="result"></div>

    <script>
      document.getElementById("checkBtn").addEventListener("click", async () => {
        const email = document.getElementById("email").value.trim();
        const result = document.getElementById("result");
        if (!email) {
          result.textContent = "Please enter an email.";
          return;
        }

        result.textContent = "Checking...";

        try {
          const res = await fetch("/.netlify/functions/get-credits", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email })
          });

          const data = await res.json();

          if (!res.ok) {
            result.textContent = data.error || "Something went wrong.";
            return;
          }

          result.textContent = `Email: ${data.email} â†’ Credits: ${data.credits}`;
        } catch (err) {
          console.error(err);
          result.textContent = "Network error.";
        }
      });
    </script>
  </body>
</html>
